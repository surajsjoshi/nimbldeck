<!DOCTYPE html>
<html lang="en">


<body>
    <script>
        (function(i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function() {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
        ga('create', 'UA-87993512-1', 'auto');
    </script>

    <script>
        var androidAppStore = "https://play.google.com/store/apps/details?id=com.nimbldeck.app&hl=en"
        function launchIframeApproach(url, alt) {
            var iframe = document.createElement("iframe");
            iframe.style.border = "none";
            iframe.style.width = "1px";
            iframe.style.height = "1px";
            iframe.onload = function() {
                document.location = alt;
            }
            document.body.appendChild(iframe);
        }

        function launchWebkitApproach(url, alt) {
            document.location = url;
            timer = setTimeout(function () {
                document.location = alt;
            }, 2500);
        }

        function launchAndroidApp(url) {
            var g_intent = "scheme=nimbldapp;package=com.nimbldeck.app;end"; //see notes below
            
            if(navigator.userAgent.match(/Chrome/)) {
                var intent = url.replace('nimbldapp', 'intent') + '#Intent;' + g_intent; //see notes below
                document.location = intent;
            } 
            else if (navigator.userAgent.match(/Firefox/)) {
                launchWebkitApproach(url, androidAppStore);
                setTimeout(function () {
                    launchIframeApproach(url, androidAppStore);
                }, 1500);
            }
            else {
                launchIframeApproach(url, androidAppStore);
            }
        }



        function getUrlParams() {
            var p = {};
            var match,
                pl = /\+/g, // Regex for replacing addition symbol with a space
                search = /([^&=]+)=?([^&]*)/g,
                decode = function(s) {
                    return decodeURIComponent(s.replace(pl, " "));
                },
                query = window.location.search.substring(1);
            while (match = search.exec(query))
                p[decode(match[1])] = decode(match[2]);
            return p;
        }
        var urlParams = getUrlParams();
        var session = urlParams['session'] || null;
        var iOS = /(iPad|iPhone|iPod)/g.test( navigator.userAgent );
        if(!iOS || session !== null) {
            ga('send', 'event', 'Shared session', 'View', session);
            launchAndroidApp(androidAppStore + "/" + session)
        } else {
            document.location = androidAppStore;
        }
       
    </script>
 
</body>

</html>